 generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum OTP_TYPE {
  LOGIN
  PASSWORD_RESET
  EMAIL_VERIFICATION
}

enum OTP_ACTION {
    CREATE
    VERIFY
    EXPIRE
}

model User { 
  id          String @id @default(cuid())
  email       String @unique
  firstName   String 
  lastName    String
  
  otpRecord Otp[]

  @@index([email])
}

model Otp {
  id String @id @default(cuid())

  userId String 
  user User @relation(fields:[userId], references: [id], onDelete: Cascade)

  email String
  action OTP_ACTION
  type OTP_TYPE

  ip_address String?

  createdAt DateTime @default(now())
  expiresAt DateTime 

  attempts Int @default(0)

  @@index([userId])
  @@index([email])
}